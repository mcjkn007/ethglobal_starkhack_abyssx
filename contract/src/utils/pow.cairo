#[generate_trait]
impl PowImpl of PowTrait {
    fn pow(base: u256, power: u32)-> u256{
        if(power == 0){
            return 1;
        }
    
        let mut result = base;
        let mut i = 1;
        loop {
            if(i == power){ 
                break;
            }
            result *= base;
            i += 1;
        };
        return result;
    }
 
    fn fast_pow(power:u32)->u256{
        if power == 0 { return 0x1; }
        if power == 1 { return 0x2; }
        if power == 2 { return 0x4; }
        if power == 3 { return 0x8; }
        if power == 4 { return 0x10; }
        if power == 5 { return 0x20; }
        if power == 6 { return 0x40; }
        if power == 7 { return 0x80; }

        if power < 16 { return PowTrait::fast_pow(power-8) * 0x100; }
        if power < 32 { return PowTrait::fast_pow(power-16) * 0x10000; }
        if power < 64 { return PowTrait::fast_pow(power-32) * 0x100000000; }
        if power < 128 { return PowTrait::fast_pow(power-64) * 0x10000000000000000; }
        if power < 256 { return u256 { low: 0x0, high: PowTrait::fast_pow(power-128).try_into().unwrap() }; }
        return 0;
    }
    fn fast_pow_2_8(power:u32)->u256{
        if(power == 0){
            return 1;
        }else if(power == 8){
            return 0x100;
        }else if(power == 16){
            return 0x10000;
        }else if(power == 24){
            return 0x1000000;
        }else if(power == 32){
            return 0x100000000;
        }else if(power == 40){
            return 0x10000000000;
        }else if(power == 48){
            return 0x1000000000000;
        }else if(power == 56){
            return 0x100000000000000;
        }else if(power == 64){
            return 0x10000000000000000;
        }else if(power == 72){
            return 0x1000000000000000000;
        }else if(power == 80){
            return 0x100000000000000000000;
        }else if(power == 88){
            return 0x10000000000000000000000;
        }else if(power == 96){
            return 0x1000000000000000000000000;
        }else if(power == 104){
            return 0x100000000000000000000000000;
        }else if(power == 112){
            return 0x10000000000000000000000000000;
        }else if(power == 120){
            return 0x1000000000000000000000000000000;
        }else if(power == 128){
            return 0x100000000000000000000000000000000;
        }else if(power == 136){
            return 0x10000000000000000000000000000000000;
        }else if(power == 144){
            return 0x1000000000000000000000000000000000000;
        }else if(power == 152){
            return 0x100000000000000000000000000000000000000;
        }else if(power == 160){
            return 0x10000000000000000000000000000000000000000;
        }else if(power == 168){
            return 0x1000000000000000000000000000000000000000000;
        }else if(power == 176){
            return 0x100000000000000000000000000000000000000000000;
        }else if(power == 184){
            return 0x10000000000000000000000000000000000000000000000;
        }else if(power == 192){
            return 0x1000000000000000000000000000000000000000000000000;
        }else if(power == 200){
            return 0x100000000000000000000000000000000000000000000000000;
        }else if(power == 208){
            return 0x10000000000000000000000000000000000000000000000000000;
        }else if(power == 216){
            return 0x1000000000000000000000000000000000000000000000000000000;
        }else if(power == 224){
            return 0x100000000000000000000000000000000000000000000000000000000;
        }else if(power == 232){
            return 0x10000000000000000000000000000000000000000000000000000000000;
        }else if(power == 240){
            return 0x1000000000000000000000000000000000000000000000000000000000000;
        }else if(power == 248){
            return 0x100000000000000000000000000000000000000000000000000000000000000;
        }else{
            return 1;
        }
    }
    fn fast_pow_2_16(power: u32) -> u256 {
        if power == 0 {
            return 1;
        } else if power == 16 {
            return 0x10000;
        } else if power == 32 {
            return 0x100000000;
        } else if power == 48 {
            return 0x1000000000000;
        } else if power == 64 {
            return 0x10000000000000000;
        } else if power == 80 {
            return 0x100000000000000000000;
        } else if power == 96 {
            return 0x1000000000000000000000000;
        } else if power == 112 {
            return 0x10000000000000000000000000000;
        } else if power == 128 {
            return 0x100000000000000000000000000000000;
        } else if power == 144 {
            return 0x1000000000000000000000000000000000000;
        } else if power == 160 {
            return 0x10000000000000000000000000000000000000000;
        } else if power == 176 {
            return 0x100000000000000000000000000000000000000000000;
        } else if power == 192 {
            return 0x1000000000000000000000000000000000000000000000000;
        } else if power == 208 {
            return 0x10000000000000000000000000000000000000000000000000000;
        } else if power == 224 {
            return 0x100000000000000000000000000000000000000000000000000000000;
        } else if power == 240 {
            return 0x1000000000000000000000000000000000000000000000000000000000000;
        }else{
            return 1;
        }  
    }
    fn fast_pow_2_32(power:u32)->u256{
        if(power == 0){
            return 1;
        }else if(power == 32){
            return 0x100000000;
        }else if(power == 64){
            return 0x10000000000000000;
        }else if(power == 96){
            return 0x1000000000000000000000000;
        }else if(power == 128){
            return 0x100000000000000000000000000000000;
        }else if(power == 160){
            return 0x10000000000000000000000000000000000000000;
        }else if(power == 192){
            return 0x1000000000000000000000000000000000000000000000000;
        }else if(power == 224){
            return 0x100000000000000000000000000000000000000000000000000000000;
        }else{
            return 1;
        }
    }
     
    fn fast_pow_2(power:u32)->u256{
        return match power {
            0 => 0x1,
            1 => 0x2,
            2 => 0x4,
            3 => 0x8,

            4 => 0x10,
            5 => 0x20,
            6 => 0x40,
            7 => 0x80,

            8 => 0x100,
            9 => 0x200,
            10 => 0x400,
            11 => 0x800,

            12 => 0x1000,
            13 => 0x2000,
            14 => 0x4000,
            15 => 0x8000,

            16 => 0x10000,
            17 => 0x20000,
            18 => 0x40000,
            19 => 0x80000,

            20 => 0x100000,
            21 => 0x200000,
            22 => 0x400000,
            23 => 0x800000,

            24 => 0x1000000,
            25 => 0x2000000,
            26 => 0x4000000,
            27 => 0x8000000,

            28 => 0x10000000,
            29 => 0x20000000,
            30 => 0x40000000,
            31 => 0x80000000,

            32 => 0x100000000,
            33 => 0x200000000,
            34 => 0x400000000,
            35 => 0x800000000,

            36 => 0x1000000000,
            37 => 0x2000000000,
            38 => 0x4000000000,
            39 => 0x8000000000,

            40 => 0x10000000000,
            41 => 0x20000000000,
            42 => 0x40000000000,
            43 => 0x80000000000,

            44 => 0x100000000000,
            45 => 0x200000000000,
            46 => 0x400000000000,
            47 => 0x800000000000,

            48 => 0x1000000000000,
            49 => 0x2000000000000,
            50 => 0x4000000000000,
            51 => 0x8000000000000,

            52 => 0x10000000000000,
            53 => 0x20000000000000,
            54 => 0x40000000000000,
            55 => 0x80000000000000,

            56 => 0x100000000000000,
            57 => 0x200000000000000,
            58 => 0x400000000000000,
            59 => 0x800000000000000,

            60 => 0x1000000000000000,
            61 => 0x2000000000000000,
            62 => 0x4000000000000000,
            63 => 0x8000000000000000,

            64 => 0x10000000000000000,
            65 => 0x20000000000000000,
            66 => 0x40000000000000000,
            67 => 0x80000000000000000,

            68 => 0x100000000000000000,
            69 => 0x200000000000000000,
            70 => 0x400000000000000000,
            71 => 0x800000000000000000,

            72 => 0x1000000000000000000,
            73 => 0x2000000000000000000,
            74 => 0x4000000000000000000,
            75 => 0x8000000000000000000,

            76 => 0x10000000000000000000,
            77 => 0x20000000000000000000,
            78 => 0x40000000000000000000,
            79 => 0x80000000000000000000,

            80 => 0x100000000000000000000,
            81 => 0x200000000000000000000,
            82 => 0x400000000000000000000,
            83 => 0x800000000000000000000,

            84 => 0x1000000000000000000000,
            85 => 0x2000000000000000000000,
            86 => 0x4000000000000000000000,
            87 => 0x8000000000000000000000,

            88 => 0x10000000000000000000000,
            89 => 0x20000000000000000000000,
            90 => 0x40000000000000000000000,
            91 => 0x80000000000000000000000,

            92 => 0x100000000000000000000000,
            93 => 0x200000000000000000000000,
            94 => 0x400000000000000000000000,
            95 => 0x800000000000000000000000,

            96 => 0x1000000000000000000000000,
            97 => 0x2000000000000000000000000,
            98 => 0x4000000000000000000000000,
            99 => 0x8000000000000000000000000,

            100 => 0x10000000000000000000000000,
            101 => 0x20000000000000000000000000,
            102 => 0x40000000000000000000000000,
            103 => 0x80000000000000000000000000,

            104 => 0x100000000000000000000000000,
            105 => 0x200000000000000000000000000,
            106 => 0x400000000000000000000000000,
            107 => 0x800000000000000000000000000,

            108 => 0x1000000000000000000000000000,
            109 => 0x2000000000000000000000000000,
            110 => 0x4000000000000000000000000000,
            111 => 0x8000000000000000000000000000,

            112 => 0x10000000000000000000000000000,
            113 => 0x20000000000000000000000000000,
            114 => 0x40000000000000000000000000000,
            115 => 0x80000000000000000000000000000,

            116 => 0x100000000000000000000000000000,
            117 => 0x200000000000000000000000000000,
            118 => 0x400000000000000000000000000000,
            119 => 0x800000000000000000000000000000,

            120 => 0x1000000000000000000000000000000,
            121 => 0x2000000000000000000000000000000,
            122 => 0x4000000000000000000000000000000,
            123 => 0x8000000000000000000000000000000,

            124 => 0x10000000000000000000000000000000,
            125 => 0x20000000000000000000000000000000,
            126 => 0x40000000000000000000000000000000,
            127 => 0x80000000000000000000000000000000,

            128 => 0x100000000000000000000000000000000,
            129 => 0x200000000000000000000000000000000,
            130 => 0x400000000000000000000000000000000,
            131 => 0x800000000000000000000000000000000,

            132 => 0x1000000000000000000000000000000000,
            133 => 0x2000000000000000000000000000000000,
            134 => 0x4000000000000000000000000000000000,
            135 => 0x8000000000000000000000000000000000,

            136 => 0x10000000000000000000000000000000000,
            137 => 0x20000000000000000000000000000000000,
            138 => 0x40000000000000000000000000000000000,
            139 => 0x80000000000000000000000000000000000,

            140 => 0x100000000000000000000000000000000000,
            141 => 0x200000000000000000000000000000000000,
            142 => 0x400000000000000000000000000000000000,
            143 => 0x800000000000000000000000000000000000,

            144 => 0x1000000000000000000000000000000000000,
            145 => 0x2000000000000000000000000000000000000,
            146 => 0x4000000000000000000000000000000000000,
            147 => 0x8000000000000000000000000000000000000,

            148 => 0x10000000000000000000000000000000000000,
            149 => 0x20000000000000000000000000000000000000,
            150 => 0x40000000000000000000000000000000000000,
            151 => 0x80000000000000000000000000000000000000,

            152 => 0x100000000000000000000000000000000000000,
            153 => 0x200000000000000000000000000000000000000,
            154 => 0x400000000000000000000000000000000000000,
            155 => 0x800000000000000000000000000000000000000,

            156 => 0x1000000000000000000000000000000000000000,
            157 => 0x2000000000000000000000000000000000000000,
            158 => 0x4000000000000000000000000000000000000000,
            159 => 0x8000000000000000000000000000000000000000,

            160 => 0x10000000000000000000000000000000000000000,
            161 => 0x20000000000000000000000000000000000000000,
            162 => 0x40000000000000000000000000000000000000000,
            163 => 0x80000000000000000000000000000000000000000,

            164 => 0x100000000000000000000000000000000000000000,
            165 => 0x200000000000000000000000000000000000000000,
            166 => 0x400000000000000000000000000000000000000000,
            167 => 0x800000000000000000000000000000000000000000,

            168 => 0x1000000000000000000000000000000000000000000,
            169 => 0x2000000000000000000000000000000000000000000,
            170 => 0x4000000000000000000000000000000000000000000,
            171 => 0x8000000000000000000000000000000000000000000,

            172 => 0x10000000000000000000000000000000000000000000,
            173 => 0x20000000000000000000000000000000000000000000,
            174 => 0x40000000000000000000000000000000000000000000,
            175 => 0x80000000000000000000000000000000000000000000,
            176 => 0x100000000000000000000000000000000000000000000,
            177 => 0x200000000000000000000000000000000000000000000,
            178 => 0x400000000000000000000000000000000000000000000,
            179 => 0x800000000000000000000000000000000000000000000,

            180 => 0x1000000000000000000000000000000000000000000000,
            181 => 0x2000000000000000000000000000000000000000000000,
            182 => 0x4000000000000000000000000000000000000000000000,
            183 => 0x8000000000000000000000000000000000000000000000,

            184 => 0x10000000000000000000000000000000000000000000000,
            185 => 0x20000000000000000000000000000000000000000000000,
            186 => 0x40000000000000000000000000000000000000000000000,
            187 => 0x80000000000000000000000000000000000000000000000,

            188 => 0x100000000000000000000000000000000000000000000000,
            189 => 0x200000000000000000000000000000000000000000000000,
            190 => 0x400000000000000000000000000000000000000000000000,
            191 => 0x800000000000000000000000000000000000000000000000,

            192 => 0x1000000000000000000000000000000000000000000000000,
            193 => 0x2000000000000000000000000000000000000000000000000,
            194 => 0x4000000000000000000000000000000000000000000000000,
            195 => 0x8000000000000000000000000000000000000000000000000,

            196 => 0x10000000000000000000000000000000000000000000000000,
            197 => 0x20000000000000000000000000000000000000000000000000,
            198 => 0x40000000000000000000000000000000000000000000000000,
            199 => 0x80000000000000000000000000000000000000000000000000,

            200 => 0x100000000000000000000000000000000000000000000000000,
            201 => 0x200000000000000000000000000000000000000000000000000,
            202 => 0x400000000000000000000000000000000000000000000000000,
            203 => 0x800000000000000000000000000000000000000000000000000,

            204 => 0x1000000000000000000000000000000000000000000000000000,
            205 => 0x2000000000000000000000000000000000000000000000000000,
            206 => 0x4000000000000000000000000000000000000000000000000000,
            207 => 0x8000000000000000000000000000000000000000000000000000,
            208 => 0x10000000000000000000000000000000000000000000000000000,
            209 => 0x20000000000000000000000000000000000000000000000000000,
            210 => 0x40000000000000000000000000000000000000000000000000000,
            211 => 0x80000000000000000000000000000000000000000000000000000,

            212 => 0x100000000000000000000000000000000000000000000000000000,
            213 => 0x200000000000000000000000000000000000000000000000000000,
            214 => 0x400000000000000000000000000000000000000000000000000000,
            215 => 0x800000000000000000000000000000000000000000000000000000,

            216 => 0x1000000000000000000000000000000000000000000000000000000,
            217 => 0x2000000000000000000000000000000000000000000000000000000,
            218 => 0x4000000000000000000000000000000000000000000000000000000,
            219 => 0x8000000000000000000000000000000000000000000000000000000,

            220 => 0x10000000000000000000000000000000000000000000000000000000,
            221 => 0x20000000000000000000000000000000000000000000000000000000,
            222 => 0x40000000000000000000000000000000000000000000000000000000,
            223 => 0x80000000000000000000000000000000000000000000000000000000,

            224 => 0x100000000000000000000000000000000000000000000000000000000,
            225 => 0x200000000000000000000000000000000000000000000000000000000,
            226 => 0x400000000000000000000000000000000000000000000000000000000,
            227 => 0x800000000000000000000000000000000000000000000000000000000,

            228 => 0x1000000000000000000000000000000000000000000000000000000000,
            229 => 0x2000000000000000000000000000000000000000000000000000000000,
            230 => 0x4000000000000000000000000000000000000000000000000000000000,
            231 => 0x8000000000000000000000000000000000000000000000000000000000,

            232 => 0x10000000000000000000000000000000000000000000000000000000000,
            233 => 0x20000000000000000000000000000000000000000000000000000000000,
            234 => 0x40000000000000000000000000000000000000000000000000000000000,
            235 => 0x80000000000000000000000000000000000000000000000000000000000,
            236 => 0x100000000000000000000000000000000000000000000000000000000000,
            237 => 0x200000000000000000000000000000000000000000000000000000000000,
            238 => 0x400000000000000000000000000000000000000000000000000000000000,
            239 => 0x800000000000000000000000000000000000000000000000000000000000,

            240 => 0x1000000000000000000000000000000000000000000000000000000000000,
            241 => 0x2000000000000000000000000000000000000000000000000000000000000,
            242 => 0x4000000000000000000000000000000000000000000000000000000000000,
            243 => 0x8000000000000000000000000000000000000000000000000000000000000,

            244 => 0x10000000000000000000000000000000000000000000000000000000000000,
            245 => 0x20000000000000000000000000000000000000000000000000000000000000,
            246 => 0x40000000000000000000000000000000000000000000000000000000000000,
            247 => 0x80000000000000000000000000000000000000000000000000000000000000,

            248 => 0x100000000000000000000000000000000000000000000000000000000000000,
            249 => 0x200000000000000000000000000000000000000000000000000000000000000,
            250 => 0x400000000000000000000000000000000000000000000000000000000000000,
            251 => 0x800000000000000000000000000000000000000000000000000000000000000,

            252 => 0x1000000000000000000000000000000000000000000000000000000000000000,
            253 => 0x2000000000000000000000000000000000000000000000000000000000000000,
            254 => 0x4000000000000000000000000000000000000000000000000000000000000000,
            255 => 0x8000000000000000000000000000000000000000000000000000000000000000,

            _ => 0
        };
    }
}

#[cfg(test)]
mod tests {

    use super::{PowTrait};

    #[test]
    #[ignore]
    #[available_gas(100_000_000)]
    fn test_pow() {
        println!("---------pow_test----------");

        let power:u32 = 200;
        let mut initial = testing::get_available_gas();
        gas::withdraw_gas().unwrap();
         
        let mut result = PowTrait::pow(2,power);
        let mut gas = initial - testing::get_available_gas();
        println!("pow consumed gas : {}", gas);

        initial = testing::get_available_gas();
        result = PowTrait::fast_pow(power);
        gas = initial - testing::get_available_gas();
        println!("fast_pow consumed gas : {}", gas);

        initial = testing::get_available_gas();
        result = PowTrait::fast_pow_2(power);
        gas = initial - testing::get_available_gas();
        println!("fast_pow_2 consumed gas : {}", gas);
        println!("---------pow_test----------");
    }

}